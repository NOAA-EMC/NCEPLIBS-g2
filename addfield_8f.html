<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>NCEPLIBS-g2: addfield.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NCEPLIBS-g2
   &#160;<span id="projectnumber">3.4.3</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('addfield_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">addfield.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Contains subroutine which packs up Sections 4 through 7 for a given field and adds them to a GRIB2 message.  
<a href="#details">More...</a></p>

<p><a href="addfield_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:abe47d00e9129168f66617de9260d91e2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="addfield_8f.html#abe47d00e9129168f66617de9260d91e2">addfield</a> (cgrib, lcgrib, ipdsnum, ipdstmpl, ipdstmplen, coordlist, numcoord, idrsnum, idrstmpl, idrstmplen, fld, ngrdpts, ibmap, bmap, ierr)</td></tr>
<tr class="memdesc:abe47d00e9129168f66617de9260d91e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine packs up Sections 4 through 7 for a given field and adds them to a GRIB2 message.  <a href="#abe47d00e9129168f66617de9260d91e2">More...</a><br/></td></tr>
<tr class="separator:abe47d00e9129168f66617de9260d91e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Contains subroutine which packs up Sections 4 through 7 for a given field and adds them to a GRIB2 message. </p>
<dl class="section author"><dt>Author</dt><dd>Stephen Gilbert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2000-05-02 </dd></dl>

<p>Definition in file <a class="el" href="addfield_8f_source.html">addfield.f</a>.</p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="abe47d00e9129168f66617de9260d91e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine addfield </td>
          <td>(</td>
          <td class="paramtype">character(len=1), dimension(lcgrib), intent(inout)&#160;</td>
          <td class="paramname"><em>cgrib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>lcgrib</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipdsnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*), intent(in)&#160;</td>
          <td class="paramname"><em>ipdstmpl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ipdstmplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(numcoord), intent(in)&#160;</td>
          <td class="paramname"><em>coordlist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>numcoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>idrsnum</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(*), intent(inout)&#160;</td>
          <td class="paramname"><em>idrstmpl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>idrstmplen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ngrdpts), intent(in), target&#160;</td>
          <td class="paramname"><em>fld</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ngrdpts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ibmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical*1, dimension(ngrdpts), intent(in)&#160;</td>
          <td class="paramname"><em>bmap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(out)&#160;</td>
          <td class="paramname"><em>ierr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine packs up Sections 4 through 7 for a given field and adds them to a GRIB2 message. </p>
<p>They are Product Definition Section, Data Representation Section, Bit-Map Section and Data Section, respectively.</p>
<p>This routine is used with routines "gribcreate", "addlocal", "addgrid", and "gribend" to create a complete GRIB2 message. Subroutine gribcreate must be called first to initialize a new GRIB2 message. Also, subroutine addgrid must be called after gribcreate and before this routine to add the appropriate grid description to the GRIB2 message. Also, a call to gribend is required to complete GRIB2 message after all fields have been added.</p>
<p>PROGRAM HISTORY LOG:</p>
<ul>
<li>2000-05-02 Stephen Gilbert</li>
<li>2002-12-17 Stephen Gilbert - Added support for new templates using PNG and JPEG2000 algorithms/templates.</li>
<li>2004-06-22 Stephen Gilbert - Added check to determine if packing algorithm failed.</li>
</ul>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">cgrib</td><td>Character array to contain the GRIB2 message. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lcgrib</td><td>Maximum length (bytes) of array cgrib. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipdsnum</td><td>Product Definition Template Number ( see Code Table 4.0). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipdstmpl</td><td>Contains the data values for the specified Product Definition Template (N=ipdsnum). Each element of this integer array contains an entry (in the order specified) of Product Defintion Template 4.N </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ipdstmplen</td><td>Max dimension of ipdstmpl coordlist Array containg floating point values intended to document the vertical discretisation associated to model data on hybrid coordinate vertical levels. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">coordlist</td><td>Array containg floating point values intended to document the vertical discretisation associated to model data on hybrid coordinate vertical levels. (part of Section 4) The dimension of this array can be obtained in advance from maxvals(5), which is returned from subroutine gribinfo. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">numcoord</td><td>- number of values in array coordlist. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idrsnum</td><td>- Data Representation Template Number ( see Code Table 5.0 ) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idrstmpl</td><td>Contains the data values for the specified Data Representation Template (N=idrsnum). Each element of this integer array contains an entry (in the order specified) of Data Representation Template 5.N. Note that some values in this template (eg. reference values, number of bits, etc...) may be changed by the data packing algorithms. Use this to specify scaling factors and order of spatial differencing, if desired. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">idrstmplen</td><td>Max dimension of idrstmpl. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fld</td><td>Array of data points to pack. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ngrdpts</td><td>Number of data points in grid. i.e. size of fld and bmap. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ibmap</td><td>Bitmap indicator (see Code Table 6.0).<ul>
<li>0 = bitmap applies and is included in Section 6.</li>
<li>1-253 = Predefined bitmap applies</li>
<li>254 = Previously defined bitmap applies to this field</li>
<li>255 = Bit map does not apply to this product. </li>
</ul>
</td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">bmap</td><td>Logical*1 array containing bitmap to be added. (if ibmap=0 or ibmap=254) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">ierr</td><td>Error return code.<ul>
<li>0 = no error</li>
<li>1 = GRIB message was not initialized. Need to call routine gribcreate first.</li>
<li>2 = GRIB message already complete. Cannot add new section.</li>
<li>3 = Sum of Section byte counts does not add to total byte count.</li>
<li>4 = Previous Section was not 3 or 7.</li>
<li>5 = Could not find requested Product Definition Template.</li>
<li>6 = Section 3 (GDS) not previously defined in message</li>
<li>7 = Tried to use unsupported Data Representationi Template</li>
<li>8 = Specified use of a previously defined bitmap, but one does not exist in the GRIB message.</li>
<li>9 = GDT of one of 5.50 through 5.53 required to pack using DRT 5.51</li>
<li>10 = Error packing data field.</li>
</ul>
</td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>Note that the Local Use Section (Section 2) can only follow Section 1 or Section 7 in a GRIB2 message.</dd></dl>
<dl class="section author"><dt>Author</dt><dd>Stephen Gilbert </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2000-05-02 </dd></dl>

<p>Definition at line <a class="el" href="addfield_8f_source.html#l00088">88</a> of file <a class="el" href="addfield_8f_source.html">addfield.f</a>.</p>

<p>References <a class="el" href="cmplxpack_8f_source.html#l00031">cmplxpack()</a>, <a class="el" href="pdstemplates_8f_source.html#l00458">pdstemplates::extpdstemplate()</a>, <a class="el" href="g2__gbytesc_8f_source.html#l00019">g2_gbytec()</a>, <a class="el" href="g2__gbytesc_8f_source.html#l00038">g2_sbytec()</a>, <a class="el" href="g2__gbytesc_8f_source.html#l00114">g2_sbytesc()</a>, <a class="el" href="getdim_8f_source.html#l00021">getdim()</a>, <a class="el" href="drstemplates_8f_source.html#l00164">drstemplates::getdrstemplate()</a>, <a class="el" href="pdstemplates_8f_source.html#l00411">pdstemplates::getpdstemplate()</a>, <a class="el" href="getpoly_8f_source.html#l00023">getpoly()</a>, <a class="el" href="jpcpack_8f_source.html#l00038">jpcpack()</a>, <a class="el" href="mkieee_8f_source.html#l00016">mkieee()</a>, <a class="el" href="pngpack_8f_source.html#l00031">pngpack()</a>, <a class="el" href="simpack_8f_source.html#l00033">simpack()</a>, and <a class="el" href="specpack_8f_source.html#l00022">specpack()</a>.</p>

<p>Referenced by <a class="el" href="putgb2_8f_source.html#l00168">putgb2()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_75b82e7e4a5feb05200b9ad7adf06257.html">home</a></li><li class="navelem"><a class="el" href="dir_b90aa5a6084b86bdb838378bc1dc161c.html">Hang.Lei</a></li><li class="navelem"><a class="el" href="dir_a172c4a69c8c4fc64ef5d9224f684072.html">noscrub</a></li><li class="navelem"><a class="el" href="dir_dd819178255f7a9ad49a3b8867a6c150.html">docus</a></li><li class="navelem"><a class="el" href="dir_648917924aeb9ce7c1fc0528dd2caf69.html">feature</a></li><li class="navelem"><a class="el" href="dir_d016ec1399c85acecef32bf81e1fad9c.html">dox</a></li><li class="navelem"><a class="el" href="dir_a7b3ebe721b8c60c479822a40383d337.html">src</a></li><li class="navelem"><a class="el" href="addfield_8f.html">addfield.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
